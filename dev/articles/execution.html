<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generating a Log • logrx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating a Log">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">logrx</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/logrx.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Use Cases</h6></li>
    <li><a class="dropdown-item" href="../articles/execution.html">Generating a Log</a></li>
    <li><a class="dropdown-item" href="../articles/generate-lockfile.html">Generate renv lockfile from log file</a></li>
    <li><a class="dropdown-item" href="../articles/tables.html">Logging for Summary Display Table</a></li>
    <li><a class="dropdown-item" href="../articles/adsl_demo.html">Logging for an ADSL dataset</a></li>
    <li><a class="dropdown-item" href="../articles/tidylog.html">Logging with {tidylog}</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Helpers</h6></li>
    <li><a class="dropdown-item" href="../articles/options.html">logrx Options</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/approved.html">Logging Unapproved Package and Function Use</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com" aria-label="slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/logrx/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generating a Log</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/logrx/blob/main/vignettes/execution.Rmd" class="external-link"><code>vignettes/execution.Rmd</code></a></small>
      <div class="d-none name"><code>execution.Rmd</code></div>
    </div>

    
    
<p><code>logrx</code> has been built with both the flexibility of code
execution and a number of different use cases in mind. While the basic
case has been outlined in our <a href="https://pharmaverse.github.io/logrx/articles/logrx.html">Get
Started</a> vignette, here we will be discussing different methods of
execution and creation of log files. These examples are meant to guide
users who wish to explore different methods of execution or for those
using <code>logrx</code> to create scripting.</p>
<div class="section level2">
<h2 id="methods-of-execution">Methods of Execution<a class="anchor" aria-label="anchor" href="#methods-of-execution"></a>
</h2>
<p>Below you will find a number of examples for different methods of
execution, these go in an increasing level of complexity and increasing
level of technical knowledge. The below examples are meant to be
starting points for those interested in using <code>logrx</code> in more
complex settings.</p>
<div class="section level3">
<h3 id="axecute">
<code>axecute()</code><a class="anchor" aria-label="anchor" href="#axecute"></a>
</h3>
<p>The easiest of the execution methods to use is
<code><a href="../reference/axecute.html">axecute()</a></code>. This function can be used to execute code from
an R terminal or using command line scripts. A log is set-up around the
program, and its code is run safely and loudly (using
<code>safely()</code> from <a href="https://purrr.tidyverse.org/" class="external-link">purrr</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/axecute.html">axecute</a></span><span class="op">(</span><span class="st">"my_script.R"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="log_-functions">
<code>log_*()</code> functions<a class="anchor" aria-label="anchor" href="#log_-functions"></a>
</h3>
<p>The <code>log_*()</code> family of functions are the core of
<code>logrx</code> and are used internally to configure, write, and
remove the log and other objects. While these are exported functions of
the package, they are intended to be used in special cases where
<code><a href="../reference/axecute.html">axecute()</a></code> will not work.</p>
<p>Use the <code>log_*()</code> functions to do the following:</p>
<ul>
<li><p><code><a href="../reference/log_init.html">log_init()</a></code> to create the environment
<code>log.rx</code></p></li>
<li><p><code><a href="../reference/log_config.html">log_config()</a></code> to add the core elements of the log to
the environment, and basic elements that are available at the time of
configuration</p></li>
<li><p><code>run_safely_loudly()</code> to execute the program code, and
capture errors, warnings, messages, output, and result. This must be
passed an executable R file to run and create the log elements
from</p></li>
<li><p><code><a href="../reference/log_write.html">log_write()</a></code> to generate and format the log</p></li>
<li><p><code><a href="../reference/log_remove.html">log_remove()</a></code> to remove the <code>log.rx</code>
environment created by code execution</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/log_config.html">log_config</a></span><span class="op">(</span><span class="st">"my_script.R"</span><span class="op">)</span></span>
<span><span class="fu">run_safely_loudly</span><span class="op">(</span><span class="st">"my_script.R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/log_write.html">log_write</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/log_remove.html">log_remove</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="command-line-execution">Command Line Execution<a class="anchor" aria-label="anchor" href="#command-line-execution"></a>
</h3>
<p>While executing from an R terminal is nice if you have access to one,
you can also execute your code using system command line. This is done
using the <code>Rscript -e</code> command which executes a file using
the registered Rscript executable. Below are a few examples of how to
use the command line to execute a file and create a log as well as how
to manipulate the outputs of the execution. These are likely to be
advanced examples for most users.</p>
<p>The below chunk will run the file my_script.R and output any standard
output that is created by the execution of the file to the default
location.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"logrx::axecute('my_script.R', log_name = 'my_script.log', log_path = '.')"</span></span></code></pre></div>
<p>The below chunk will run the file <code>my_script.R</code> and output
any standard output that is created by the execution of the file to a
file called <code>temp.log</code>. This output can then later be
accessed should the user want to check the output of the file
execution.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"logrx::axecute('my_script.R', log_name = 'my_script.log', log_path = '.')"</span> <span class="op">&gt;</span> temp.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span></code></pre></div>
<p>The below chunk will run the file <code>my_script.R</code> and output
any standard output that is created by the execution of the file to a
file called <code>temp.log</code>. It will then take the contents of the
<code>temp.log</code> file and add those to the end of the log file
generated by the file execution and remove the temporary output log.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"logrx::axecute('my_script.R', log_name = 'my_script.log', log_path = '.')"</span> <span class="op">&gt;</span> temp.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span><span class="kw">;</span> <span class="fu">cat</span> my_script.log <span class="op">&gt;&gt;</span> my_script.log<span class="kw">;</span> <span class="fu">rm</span> my_script.log</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="scripting-with-logrx">Scripting with <code>logrx</code><a class="anchor" aria-label="anchor" href="#scripting-with-logrx"></a>
</h2>
<p>While <code>logrx</code> is built around creating a log for a program
it can just as easily be used when running an entire set of programs.
The <code><a href="../reference/axecute.html">axecute()</a></code> function has been built with both single file
execution and scripted file execution in mind. With the use of simple
functions such as <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> scripting is easy. Below is some
sample code of how <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> can be used with
<code><a href="../reference/axecute.html">axecute()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"file.R"</span>, <span class="st">"otherfile.R"</span><span class="op">)</span>, <span class="va">axecute</span><span class="op">)</span></span></code></pre></div>
<p>If your scripting needs to work on the contents of a directory
instead of a pre-defined list, functions such as <code>list.files</code>
can be used to obtain a list of files to use. Below is an example of how
this can be applied in practice by getting all files ending in
<code>.R</code> in the current working directory using a regular
expression, and then using <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> to run the files using
<code><a href="../reference/axecute.html">axecute()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_script_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"."</span>, pattern <span class="op">=</span> <span class="st">"\\.R$"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">r_script_list</span>, <span class="va">axecute</span><span class="op">)</span></span></code></pre></div>
<p>Additionally, if you need your code to run using a shell scripting
language such as bash these files can be created to run using the
previously outlined Command Line Execution examples. The above scripting
examples can be translated into a variety of different scripting
languages. Below is an example where the bash script is executed in a
directory of R files, this should execute all R files in the directory
using <code><a href="../reference/axecute.html">axecute()</a></code> and create a corresponding set of log
files.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="cf">for</span> file <span class="kw">in</span> <span class="pp">*</span>.R<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>    <span class="bu">[</span> <span class="ot">-f</span> <span class="st">"</span><span class="va">$file</span><span class="st">"</span> <span class="bu">]</span> <span class="kw">||</span> <span class="cf">continue</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"logrx::axecute('</span><span class="va">$file</span><span class="st">')"</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan Kosiba, Thomas Bermudez, Ben Straub, Michael Rimler, Nicholas Masel, Sam Parmar, GSK/Atorus JPT.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
